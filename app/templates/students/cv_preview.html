{% extends "base.html" %}
{% block content %}
<style>
  .cv-premium { max-width: 980px; margin: 0 auto; background: #fff; box-shadow: 0 12px 30px rgba(15, 23, 42, .12); border: 1px solid #e5e7eb; overflow: hidden; }
  .cv-head { display: grid; grid-template-columns: 140px 1fr; gap: 1rem; padding: 1.2rem 1.3rem; background: #f3f4f6; border-bottom: 1px solid #e5e7eb; }
  .cv-head .avatar-wrap { width: 120px; height: 120px; border-radius: 6px; background: #d1d5db; display: flex; align-items: center; justify-content: center; overflow: hidden; }
  .cv-head .avatar { width: 100%; height: 100%; object-fit: cover; }
  .cv-head .avatar-fallback { color: #374151; font-size: .85rem; font-weight: 600; }
  .cv-name { font-size: 2rem; font-weight: 800; line-height: 1.05; margin: 0; text-transform: uppercase; color: #1f2937; }
  .cv-role { margin-top: .25rem; color: #6b7280; font-weight: 600; }
  .cv-contact { background: #e5e7eb; padding: .6rem 1rem; font-size: .9rem; display: grid; gap: .45rem; grid-template-columns: repeat(3, minmax(0,1fr)); }
  .cv-main { display: grid; grid-template-columns: 34% 66%; min-height: 560px; }
  .cv-left { background: #f3f4f6; padding: 1.1rem; }
  .cv-right { padding: 1.1rem 1.2rem; }
  .cv-section { margin-bottom: 1rem; }
  .cv-section h3 { font-size: .92rem; letter-spacing: .04em; text-transform: uppercase; border-bottom: 1px solid #9ca3af; padding-bottom: .25rem; margin-bottom: .45rem; font-weight: 800; }
  .cv-section ul { margin: 0; padding-left: 1.1rem; }
  .cv-section li { margin-bottom: .2rem; }
  .cv-empty { color: #9ca3af; font-style: italic; }
  .cv-bottom { height: 12px; background: #0ea5e9; }
  @media (max-width: 991.98px) { .cv-contact { grid-template-columns: 1fr; } }
  @media (max-width: 767.98px) {
    .cv-head { grid-template-columns: 1fr; }
    .cv-main { grid-template-columns: 1fr; }
    .cv-name { font-size: 1.6rem; }
  }
</style>
<div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2">
  <h1 class="h4 mb-0">Apercu CV - {{ student.nom }} {{ student.prenoms }}</h1>
  <div class="d-flex gap-2">
    <a class="btn btn-outline-secondary" href="{{ url_for('students.view_student', student_id=student.id) }}">Retour fiche</a>
    <a class="btn btn-outline-primary" href="{{ url_for('students.edit_student_cv', student_id=student.id) }}">Modifier CV</a>
    <a class="btn btn-primary" href="{{ url_for('students.download_student_cv_pdf', student_id=student.id) }}">Telecharger PDF</a>
  </div>
</div>

<div class="cv-premium">
  <div class="cv-head">
    <div class="avatar-wrap">
      {% if student.photo_path %}
      <img src="{{ url_for('static', filename='uploads/photos/' ~ student.photo_path) }}" alt="Photo" class="avatar">
      {% else %}
      <span class="avatar-fallback">PHOTO</span>
      {% endif %}
    </div>
    <div>
      <h2 class="cv-name">{{ student.nom }}<br>{{ student.prenoms }}</h2>
      {% if student.program_wished %}
      <div class="cv-role">{{ student.program_wished }}</div>
      {% endif %}
    </div>
  </div>
  <div class="cv-contact">
    <div><strong>Tel :</strong> {{ student.telephone or '-' }}</div>
    <div><strong>Email :</strong> {{ student.email or '-' }}</div>
    <div><strong>Adresse :</strong> {{ student.adresse or '-' }}</div>
  </div>
  <div class="cv-main">
    <div class="cv-left">
      {% if cv.show_education and education_items %}
      <div class="cv-section"><h3>Education</h3><ul>{% for it in education_items %}<li>{{ it }}</li>{% endfor %}</ul></div>
      {% endif %}
      {% if cv.show_languages and languages_items %}
      <div class="cv-section"><h3>Langues</h3><ul>{% for it in languages_items %}<li>{{ it }}</li>{% endfor %}</ul></div>
      {% endif %}
      {% if cv.show_software and software_items %}
      <div class="cv-section"><h3>Logiciels</h3><ul>{% for it in software_items %}<li>{{ it }}</li>{% endfor %}</ul></div>
      {% endif %}
      {% if cv.show_hobbies and hobbies_items %}
      <div class="cv-section"><h3>Centres d'interet</h3><ul>{% for it in hobbies_items %}<li>{{ it }}</li>{% endfor %}</ul></div>
      {% endif %}
      {% if not ((cv.show_education and education_items) or (cv.show_languages and languages_items) or (cv.show_software and software_items) or (cv.show_hobbies and hobbies_items)) %}
      <div class="cv-empty">Aucune information a gauche pour le moment.</div>
      {% endif %}
    </div>
    <div class="cv-right">
      <div class="cv-section">
        <h3>Profil</h3>
        <p class="mb-0">{{ (cv.profile_text or 'Profil non renseigne')|e|replace('\n','<br>')|safe }}</p>
      </div>
      {% if cv.show_professional_experience and professional_items %}
      <div class="cv-section"><h3>Experiences professionnelles</h3><ul>{% for it in professional_items %}<li>{{ it }}</li>{% endfor %}</ul></div>
      {% endif %}
      {% if cv.show_extra_experience and extra_items %}
      <div class="cv-section"><h3>Experiences extra-professionnelles</h3><ul>{% for it in extra_items %}<li>{{ it }}</li>{% endfor %}</ul></div>
      {% endif %}
      {% if cv.show_skills and skills_items %}
      <div class="cv-section"><h3>Expertise</h3><ul>{% for it in skills_items %}<li>{{ it }}</li>{% endfor %}</ul></div>
      {% endif %}
      {% if cv.show_social_links and social_items %}
      <div class="cv-section"><h3>Suivez-moi</h3><ul>{% for it in social_items %}<li>{{ it }}</li>{% endfor %}</ul></div>
      {% endif %}
      {% if cv.contact_details %}
      <div class="cv-section"><h3>Coordonnees complementaires</h3><p class="mb-0">{{ cv.contact_details|e|replace('\n','<br>')|safe }}</p></div>
      {% endif %}
      {% if not ((cv.show_professional_experience and professional_items) or (cv.show_extra_experience and extra_items) or (cv.show_skills and skills_items) or (cv.show_social_links and social_items) or cv.contact_details or cv.profile_text) %}
      <div class="cv-empty">Aucune information a droite pour le moment.</div>
      {% endif %}
    </div>
  </div>
  <div class="cv-bottom"></div>
</div>
{% endblock %}

